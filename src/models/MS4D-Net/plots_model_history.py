import matplotlib.pyplot as plt
from matplotlib.ticker import MaxNLocator
import matplotlib.ticker as tck

train_data = {'train': {'epoch': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19], 'loss': [2.1789137634588647, 1.904442789641069, 1.5110112771469077, 1.138963060366675, 1.0177816083085351, 1.0333900328127215, 0.9970167761794027, 0.9933582548187186, 0.9843779474188009, 0.9664634621359524, 0.9679191828237297, 0.9690001474143309, 0.9597298976207644, 0.9813772611358623, 0.963548513505743, 0.9580742446560934, 0.9603557804396733, 0.958328857631881, 0.9594560648493199, 0.9615493252332964], 'acc': [0.5990932583808899, 0.7443704009056091, 0.7721538543701172, 0.7861036658287048, 0.7856629490852356, 0.7797839045524597, 0.785702109336853, 0.7831431031227112, 0.7833981513977051, 0.7860409617424011, 0.7873413562774658, 0.7854654788970947, 0.7879191040992737, 0.7848058342933655, 0.7867242693901062, 0.7872776985168457, 0.786126434803009, 0.7871711850166321, 0.7886888384819031, 0.7869191765785217], 'miou': [0.1718732863664627, 0.20499558746814728, 0.20830881595611572, 0.20066240429878235, 0.18790365755558014, 0.1990775465965271, 0.19165979325771332, 0.1900402158498764, 0.19015668332576752, 0.19315175712108612, 0.1929127722978592, 0.19028642773628235, 0.19243879616260529, 0.19318197667598724, 0.19026319682598114, 0.19261884689331055, 0.1907314509153366, 0.19140022993087769, 0.193557471036911, 0.1906271129846573], 'prec': [0.4033565, 0.4404031, 0.48717326, 0.5428792, 0.55882734, 0.51428306, 0.55842507, 0.54484016, 0.54336596, 0.5517545, 0.55945027, 0.557673, 0.5644441, 0.54986393, 0.5619329, 0.5592642, 0.559916, 0.5619935, 0.5694621, 0.56988275], 'recall': [0.48691782, 0.51870656, 0.42223734, 0.2870512, 0.18696675, 0.29420805, 0.21358265, 0.20711076, 0.20869435, 0.22578153, 0.2206237, 0.20449416, 0.21531807, 0.22751579, 0.20184791, 0.21850017, 0.20641623, 0.20930265, 0.22117667, 0.20265736], 'f_score': [0.44121563, 0.4763584, 0.45238692, 0.37553543, 0.2801903, 0.37429285, 0.3089863, 0.300132, 0.30156466, 0.32043782, 0.31645203, 0.2992542, 0.3117233, 0.32185742, 0.29700926, 0.31423226, 0.30163354, 0.30501056, 0.3186075, 0.2989901]}, 'valid': {'epoch': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19], 'loss': [2.832258845484534, 2.695003088130507, 1.967745395593865, 1.634031747662744, 1.5003721353619597, 1.4459323661271917, 1.482394623201947, 1.4801575278126917, 1.4821350519047227, 1.4797441543534744, 1.4546006751614948, 1.4430350037508233, 1.4270588547684426, 1.3863779361857924, 1.3764466878979704, 1.3469561477040135, 1.3419696674790493, 1.3450117138929145, 1.300553698872411, 1.2960980049399442], 'acc': [0.3253566324710846, 0.42726364731788635, 0.57275390625, 0.723895788192749, 0.7060584425926208, 0.643923819065094, 0.6110750436782837, 0.5809109807014465, 0.5717800259590149, 0.5187433958053589, 0.48768189549446106, 0.5142272114753723, 0.5164337754249573, 0.5452985763549805, 0.5656889081001282, 0.567146897315979, 0.5920681357383728, 0.61629319190979, 0.6229174137115479, 0.6226908564567566], 'miou': [0.08722084015607834, 0.11011530458927155, 0.15861667692661285, 0.20924213528633118, 0.20268087089061737, 0.18071137368679047, 0.17085936665534973, 0.16082850098609924, 0.15805673599243164, 0.14036357402801514, 0.12998221814632416, 0.13887932896614075, 0.1395576447248459, 0.14881816506385803, 0.15552838146686554, 0.15582986176013947, 0.16391897201538086, 0.17194683849811554, 0.1740953028202057, 0.1740933358669281], 'prec': [0.28558186, 0.28028902, 0.3331748, 0.44190794, 0.42152715, 0.36652857, 0.35028693, 0.33478323, 0.33193135, 0.31047374, 0.29939133, 0.3091264, 0.30934873, 0.31773487, 0.326317, 0.32584548, 0.33715132, 0.35042834, 0.35406607, 0.3542676], 'recall': [0.90189826, 0.9385857, 0.8382294, 0.6678705, 0.6809054, 0.72235346, 0.7868047, 0.8157572, 0.8360721, 0.8829186, 0.9049918, 0.88866216, 0.88205475, 0.83702165, 0.81814486, 0.8085768, 0.7815509, 0.76014036, 0.7523731, 0.75489086], 'f_score': [0.43380222, 0.4316691, 0.47682416, 0.531885, 0.5207033, 0.48630276, 0.4847585, 0.4747366, 0.47520155, 0.4594014, 0.44993442, 0.45869353, 0.45805225, 0.4606183, 0.46655044, 0.46450266, 0.47108322, 0.4797087, 0.48152632, 0.48222753]}}
train_data = {'train': {'epoch': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20], 'loss': [2.0105711922744396, 1.78393343415285, 1.4390462610696881, 1.1271099567104497, 1.0113507703795952, 1.0060242350391773, 0.9744904235854668, 0.9715892845484877, 0.9701362549486555, 0.9673497371877413, 0.9686912144558417, 0.9689552162440948, 0.9801571122105257, 0.9675189127730582, 0.9600290968782543, 0.9577951358698811, 0.9610642859509572, 0.9563651555097165, 0.9452399107304261, 0.9393573536928453, 0.9489583110562261], 'acc': [0.6308165788650513, 0.7480762004852295, 0.7688612341880798, 0.7873300313949585, 0.7880145311355591, 0.7808750867843628, 0.7838221788406372, 0.7859446406364441, 0.783850371837616, 0.7845573425292969, 0.7855350971221924, 0.7845485806465149, 0.7836547493934631, 0.7853196859359741, 0.7863239645957947, 0.7865771651268005, 0.7857255935668945, 0.7873871326446533, 0.7910725474357605, 0.7913514971733093, 0.7886806130409241], 'miou': [0.17694400250911713, 0.20542795956134796, 0.21027790009975433, 0.19915366172790527, 0.19128118455410004, 0.19378724694252014, 0.18808263540267944, 0.18888767063617706, 0.18741099536418915, 0.18356725573539734, 0.18253450095653534, 0.18138694763183594, 0.1796390265226364, 0.18302804231643677, 0.1861013025045395, 0.1866646111011505, 0.18505001068115234, 0.18933920562267303, 0.1953144073486328, 0.19793187081813812, 0.19101949036121368], 'prec': [0.3843686, 0.44351032, 0.4804485, 0.54286945, 0.57290006, 0.51768756, 0.5468825, 0.5572611, 0.54681, 0.5672361, 0.5815217, 0.5792209, 0.5716392, 0.5685527, 0.57370543, 0.5737087, 0.57428676, 0.56483924, 0.5818182, 0.5719038, 0.5764929], 'recall': [0.5145035, 0.5067526, 0.4624803, 0.27261925, 0.20563154, 0.24651518, 0.19255608, 0.19375525, 0.18766683, 0.15797627, 0.1487184, 0.14266285, 0.13304812, 0.15316735, 0.17202573, 0.17536554, 0.16562362, 0.19378424, 0.22868873, 0.24945919, 0.20225894], 'f_score': [0.44001585, 0.47302702, 0.4712932, 0.36296436, 0.3026372, 0.3339895, 0.28482568, 0.28753638, 0.27943182, 0.24712719, 0.23686177, 0.22893798, 0.21585609, 0.2413227, 0.26468545, 0.26862153, 0.25709993, 0.28856725, 0.32832605, 0.34739003, 0.2994557]}, 'valid': {'epoch': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20], 'loss': [2.350465630376062, 2.3084753280462222, 1.9515037730682727, 1.5560222891874091, 1.4392365189485772, 1.2905125978381136, 1.3570458195930304, 1.349979325782421, 1.264400188312974, 1.2147562004799066, 1.2295893527740656, 1.2187735646270041, 1.238102185171704, 1.241116192451743, 1.282801256623379, 1.259182990983475, 1.253760767537494, 1.2571281721425611, 1.2488780160282933, 1.2632851628370063, 1.2399356254311495], 'acc': [0.43498384952545166, 0.46283233165740967, 0.5015528202056885, 0.7240208387374878, 0.7560982704162598, 0.7093923687934875, 0.6252963542938232, 0.6182873845100403, 0.6977699398994446, 0.748566210269928, 0.7624675035476685, 0.7677639126777649, 0.7685039639472961, 0.765387773513794, 0.7557998299598694, 0.7563253045082092, 0.7549682259559631, 0.7508236169815063, 0.7484712600708008, 0.7389644384384155, 0.7391111850738525], 'miou': [0.11280371993780136, 0.12182541191577911, 0.1348477154970169, 0.2091275304555893, 0.21942591667175293, 0.20687070488929749, 0.17668969929218292, 0.17297771573066711, 0.19236494600772858, 0.19937673211097717, 0.19257444143295288, 0.18352119624614716, 0.18937276303768158, 0.193987175822258, 0.19788318872451782, 0.1914951652288437, 0.18669621646404266, 0.19844985008239746, 0.20413361489772797, 0.2032361477613449, 0.2015099972486496], 'prec': [0.28508803, 0.29362062, 0.30766857, 0.44213808, 0.4871169, 0.43074352, 0.36281642, 0.35318205, 0.39827123, 0.47149032, 0.5259454, 0.59699214, 0.5773665, 0.5415783, 0.493751, 0.49698755, 0.49233967, 0.477714, 0.4740459, 0.4562703, 0.4550536], 'recall': [0.94926053, 0.93869174, 0.92197984, 0.66463935, 0.6083928, 0.74279565, 0.8086055, 0.7702488, 0.54750395, 0.37990528, 0.2617386, 0.17605795, 0.21787207, 0.26479498, 0.3346154, 0.27172986, 0.23404415, 0.3602519, 0.43634087, 0.4732465, 0.44965878], 'f_score': [0.43848687, 0.44732043, 0.46137452, 0.53102344, 0.5410421, 0.5452812, 0.50088763, 0.4842987, 0.46111396, 0.4207719, 0.34953156, 0.27192342, 0.316363, 0.35568443, 0.3988976, 0.35135502, 0.31726813, 0.41075027, 0.45441258, 0.4646034, 0.4523401]}}
train_data = {'train': {'epoch': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], 'loss': [2.200899422477564, 1.9265713426115598, 1.5509775509488397, 1.1638662779578273, 1.015350559214854, 1.0374329440643133, 1.0311538397957005, 0.9897444827260131, 0.9769767999185799, 0.9883666714856044, 0.9662924618918661, 0.9657348646864372, 0.9653440381115582, 0.9652935068069962, 0.9575184473256373, 0.9724128020859752, 0.9600309794430906, 0.9611609559602688, 0.9536520559244205, 0.9521726780604822, 0.9546255209903025, 0.9516620853713139, 0.9562140243041083, 0.9503235505806967, 0.9469340811121649, 0.9531709825127853, 0.9464019112327556, 0.9490779600458442, 0.9448514020967977, 0.9416646941183763, 0.9435973991229745, 0.9420295618667504, 0.9478268179405539, 0.9474149396536882, 0.9371017431502515, 0.9380894162803116, 0.9368831504503062, 0.9420463510745548, 0.9384198512283631, 0.9367929939470143, 0.9467507675676148], 'acc': [0.6032899022102356, 0.7411478757858276, 0.7633261680603027, 0.7844959497451782, 0.7877492308616638, 0.7818453311920166, 0.7817312479019165, 0.7817590236663818, 0.7827271819114685, 0.783805787563324, 0.7858150005340576, 0.7873227596282959, 0.7850160598754883, 0.7866968512535095, 0.7887498736381531, 0.7846390604972839, 0.7868364453315735, 0.7870643138885498, 0.78709876537323, 0.7881977558135986, 0.7889444828033447, 0.7883517146110535, 0.7882071137428284, 0.7905066013336182, 0.7901661992073059, 0.7880784869194031, 0.7901310324668884, 0.7895779609680176, 0.7904074788093567, 0.7914576530456543, 0.7899957299232483, 0.7923804521560669, 0.7922333478927612, 0.7904732823371887, 0.7923056483268738, 0.792384147644043, 0.7915129065513611, 0.7923187613487244, 0.7912800908088684, 0.7918879985809326, 0.7910535931587219], 'miou': [0.17172257602214813, 0.20363597571849823, 0.20854781568050385, 0.20239543914794922, 0.19218365848064423, 0.1975426822900772, 0.192650705575943, 0.18661053478717804, 0.18964838981628418, 0.19156138598918915, 0.19089944660663605, 0.1927550882101059, 0.18960689008235931, 0.18999452888965607, 0.193559929728508, 0.19128011167049408, 0.19059567153453827, 0.19268128275871277, 0.19126291573047638, 0.19235943257808685, 0.1941557377576828, 0.1939108818769455, 0.19190731644630432, 0.19609437882900238, 0.1943155974149704, 0.1942501813173294, 0.19504037499427795, 0.1940586119890213, 0.1969837099313736, 0.19874271750450134, 0.19417208433151245, 0.19824135303497314, 0.19801616668701172, 0.1958850622177124, 0.1982174962759018, 0.19765885174274445, 0.1982540339231491, 0.1982516646385193, 0.19813017547130585, 0.1982852965593338, 0.1970137506723404], 'prec': [0.39061627, 0.43224436, 0.46826467, 0.52777135, 0.5695726, 0.5234322, 0.52514815, 0.5353717, 0.5385243, 0.53928864, 0.5522104, 0.56199884, 0.5524572, 0.5637256, 0.57095385, 0.554618, 0.5638855, 0.56203306, 0.5608124, 0.5684062, 0.56801665, 0.5689337, 0.57058835, 0.5747309, 0.573756, 0.5667476, 0.5725986, 0.57142407, 0.5722701, 0.57478946, 0.5754355, 0.5778288, 0.5838505, 0.5782361, 0.5775647, 0.5837776, 0.57465184, 0.58573836, 0.5730599, 0.576244, 0.580692], 'recall': [0.4956164, 0.5232964, 0.46945342, 0.31062248, 0.21297066, 0.27472752, 0.23402323, 0.18649492, 0.20683976, 0.21913008, 0.2091794, 0.21903567, 0.20092681, 0.19944362, 0.22128566, 0.21302272, 0.20371479, 0.21887217, 0.20861065, 0.21350497, 0.2257526, 0.22477505, 0.20980756, 0.23652542, 0.22404493, 0.22815174, 0.22962092, 0.223551, 0.2438062, 0.25486374, 0.22302915, 0.2489446, 0.24644238, 0.23440462, 0.24894352, 0.2434774, 0.2510684, 0.24768586, 0.25086364, 0.2504537, 0.24146053], 'f_score': [0.4368962, 0.47343227, 0.4688583, 0.39107552, 0.31002057, 0.36033192, 0.3237658, 0.27662757, 0.29888278, 0.3116336, 0.30342156, 0.31521732, 0.29467964, 0.29464364, 0.31895378, 0.3078165, 0.29930112, 0.31505334, 0.30410174, 0.31041265, 0.3230945, 0.32223937, 0.3068026, 0.33513075, 0.32225364, 0.3253354, 0.32779214, 0.32137468, 0.34193614, 0.3531427, 0.32146418, 0.34797287, 0.34658977, 0.33358213, 0.34792393, 0.34363443, 0.34945717, 0.34815192, 0.34896418, 0.3491541, 0.34109047]}, 'valid': {'epoch': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], 'loss': [2.518766673405965, 2.9047198242611354, 2.6673609097798665, 1.7579999075995552, 1.5978784137301976, 1.5651849614249336, 1.668232586648729, 1.6289488315582275, 1.580966560045878, 1.615935410393609, 1.5428787840737237, 1.5353055583106148, 1.5044362968868679, 1.549082416958279, 1.5010736597908867, 1.4745997111002604, 1.4852252112494575, 1.4615779956181845, 1.4280637979507447, 1.4379662301805285, 1.3990493721432156, 1.385761931207445, 1.3581075933244493, 1.3876511282391017, 1.3111811267005073, 1.3297698047426012, 1.3505140860875449, 1.3096791797214085, 1.3437853124406602, 1.3398999955919053, 1.3120446576012506, 1.3147844235102335, 1.3234722269905939, 1.320565644900004, 1.3080698304706149, 1.297620447476705, 1.3316661569807264, 1.329164809650845, 1.3207813501358032, 1.3195745415157742, 1.3166920608944364], 'acc': [0.3851689100265503, 0.4180131256580353, 0.4192536473274231, 0.5868338942527771, 0.5935232639312744, 0.6173520684242249, 0.549574613571167, 0.5617415904998779, 0.547122061252594, 0.5396535396575928, 0.548403799533844, 0.5563845038414001, 0.5733579993247986, 0.5627619624137878, 0.5727246403694153, 0.5956475734710693, 0.5946347117424011, 0.5903930068016052, 0.623249351978302, 0.5945751667022705, 0.6168872117996216, 0.6252310872077942, 0.6361597180366516, 0.6364717483520508, 0.6654371619224548, 0.6533991098403931, 0.6490703225135803, 0.6510396003723145, 0.6615086793899536, 0.6679027080535889, 0.6816065311431885, 0.688801646232605, 0.7011525630950928, 0.713128387928009, 0.7115883231163025, 0.7214943766593933, 0.7037555575370789, 0.7014882564544678, 0.7037618160247803, 0.7059788107872009, 0.7093538045883179], 'miou': [0.1018855944275856, 0.10867588967084885, 0.10939811915159225, 0.16175960004329681, 0.16381652653217316, 0.17056742310523987, 0.1489812135696411, 0.15297602117061615, 0.14838938415050507, 0.1457527130842209, 0.14879672229290009, 0.15152104198932648, 0.15676632523536682, 0.1535356491804123, 0.1565527617931366, 0.16382400691509247, 0.16362473368644714, 0.1618858426809311, 0.17193901538848877, 0.1627989262342453, 0.16945748031139374, 0.1726895421743393, 0.17619529366493225, 0.17609329521656036, 0.18462632596492767, 0.18244634568691254, 0.18131498992443085, 0.18114601075649261, 0.18489742279052734, 0.18689082562923431, 0.19049964845180511, 0.1924840807914734, 0.19420455396175385, 0.19794292747974396, 0.19819508492946625, 0.20027212798595428, 0.19594676792621613, 0.19564540684223175, 0.19634704291820526, 0.19702838361263275, 0.19798511266708374], 'prec': [0.27259105, 0.26225787, 0.26219016, 0.32028118, 0.32308236, 0.33116204, 0.29966784, 0.3054348, 0.3000957, 0.29537377, 0.30051985, 0.3048432, 0.31090808, 0.30717504, 0.3105577, 0.32079408, 0.32093817, 0.31713292, 0.33276632, 0.3174304, 0.32731566, 0.3345063, 0.3412269, 0.3408048, 0.35875586, 0.35519692, 0.3528154, 0.35174596, 0.360136, 0.36460215, 0.3736117, 0.379318, 0.38682204, 0.39989147, 0.39927858, 0.4095566, 0.3909493, 0.38928267, 0.3915562, 0.39384007, 0.39728123], 'recall': [0.92250526, 0.924516, 0.92570686, 0.80080354, 0.79105616, 0.7378193, 0.80149704, 0.7961541, 0.8128298, 0.8067672, 0.8114952, 0.81228626, 0.7889018, 0.8050317, 0.789033, 0.76527363, 0.7705737, 0.7615017, 0.7176171, 0.7439661, 0.7107288, 0.7191061, 0.7087234, 0.7031975, 0.6568987, 0.7091906, 0.7204774, 0.69822544, 0.6961376, 0.68739575, 0.65439516, 0.6395833, 0.5837853, 0.56933105, 0.5838465, 0.55429137, 0.5972299, 0.6075328, 0.6044705, 0.6014024, 0.59526175], 'f_score': [0.42083085, 0.40860623, 0.4086402, 0.45756096, 0.4587873, 0.45714128, 0.4362342, 0.44149533, 0.4383523, 0.43242717, 0.43860993, 0.44331467, 0.44603336, 0.44467568, 0.4456936, 0.45208094, 0.45314488, 0.44778323, 0.45468882, 0.44499385, 0.4482133, 0.456611, 0.46066085, 0.45910448, 0.46406773, 0.4733282, 0.47367412, 0.46781844, 0.4746956, 0.47647616, 0.4756577, 0.47620994, 0.46531898, 0.46980053, 0.47423753, 0.47105706, 0.47255927, 0.47451505, 0.47525668, 0.4759772, 0.4765261]}}

train_data.keys()

train_data['valid'].keys()


loss_train = train_data['train']['loss']
f1_train = train_data['train']['f_score']
miou_train = train_data['train']['miou']
epochs = train_data['train']['epoch']

loss_val = train_data['valid']['loss']
f1_val = train_data['valid']['f_score']
miou_val = train_data['valid']['miou']

### Plotting the loss curves

fig, ax = plt.subplots(figsize=(6, 4))
ax.xaxis.set_major_locator(tck.MultipleLocator())
ax.set_xlabel('Epochs')

ax.plot(epochs, loss_train, 'g', label='Training Loss')
ax.plot(epochs, loss_val, 'b', label='Validation Loss')

ax.xaxis.set_major_locator(MaxNLocator(integer=True))
plt.ylabel('Loss')
plt.legend()
plt.show()


### F1 figure

fig, ax = plt.subplots(figsize=(6, 4))
ax.xaxis.set_major_locator(tck.MultipleLocator())
ax.set_xlabel('Epochs')

plt.plot(epochs, f1_train, 'g', linestyle='--', label='Training F1')
plt.plot(epochs, f1_val, 'b', linestyle='--', label='Validation F1')


ax.xaxis.set_major_locator(MaxNLocator(integer=True))
plt.ylabel('F1')
plt.legend()
plt.show()

### MIoU figure

fig, ax = plt.subplots(figsize=(6, 4))
ax.xaxis.set_major_locator(tck.MultipleLocator())
ax.set_xlabel('Epochs')

plt.plot(epochs, miou_train, 'g', linestyle='--', label='Training MIOU')
plt.plot(epochs, miou_val, 'b', linestyle='--', label='Validation MIOU')


ax.xaxis.set_major_locator(MaxNLocator(integer=True))
plt.ylabel('MIOU')
plt.legend()
plt.show()